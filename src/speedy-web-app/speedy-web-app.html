<!-- Copyright (C) Digital Vecte - All Rights Reserved
  Unauthorized copying of this file, via any medium is strictly prohibited
 Proprietary and confidential
 Written by Matthew Miller <mattymil@digitalvecte.com>, January, 2017
 -->

<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/app-layout/app-layout.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../speedy-charts/speedy-charts.html">
<link rel="import" href="../speedy-landing/speedy-landing.html">
<link href="../../bower_components/iron-icons/iron-icons.html" rel="import">
<link href="../../bower_components/paper-icon-button/paper-icon-button.html" rel="import">
<link rel="import" href="../speedy-login/speedy-login.html">
<script src="https://www.gstatic.com/firebasejs/3.6.6/firebase.js"></script>


<dom-module id="speedy-web-app">
  <template>
    <style>
      :host {
        display: block;
        font-family: Arial, sans-serif;
      }
      #logoPic {
      margin : 7px 0 7px 0;
      }
      #logo {
        margin-right: 1.5%;
      }
      app-header {
        background-color: #232625;
      }
      speedy-charts {
        margin: 20px 20px 20px 20px;
      }
      #title {
        color: #fff;
      }
      #ham {
        position: fixed;
        right: 22px;
        color: #fff;
      }

    </style>

    <app-location route="{{route}}" use-hash-as-path></app-location>

    <app-route route="{{route}}" pattern="/:view" data="{{routeData}}" tail="{{tail}}"></app-route>
    <app-drawer-layout force-narrow>
      <app-drawer align="end">
        <ul>
          <li><a href="/#/home" drawer-toggle>Home</a></li>
          <li><a href="/#/register" drawer-toggle>Register</a></li>
          <li><a href="/#/login" drawer-toggle>Login</a></li>
          <li><a href="/#/charts" drawer-toggle>Charts</a></li>
          <li><a href="/#/configure" drawer-toggle>Configure</a></li>
        </ul>
      </app-drawer>
    <app-header-layout>
      <app-header fixed shadow>
        <app-toolbar id="logoPic">
          <img id="logo" src="../images/logo-speedy.png" alt="logo">
            <img id="logo" src="../images/title.png" alt="speedy Title">
            <paper-icon-button id="ham" icon="menu" drawer-toggle></paper-icon-button>
        </app-toolbar>
      </app-header>
      <iron-pages selected="{{routeData.view}}" attr-for-selected="name">
        <speedy-landing name="home"></speedy-landing>
        <speedy-charts firebase="{{fbase}}" name="charts"></speedy-charts>
        <speedy-login firebase="{{fbase}}" name="login"></speedy-login>
      </iron-pages>
    </app-header-layout>
  </app-drawer-layout>
  </template>

  <script>
    Polymer({
      is: 'speedy-web-app',
      ready: function() {

        // database config
        var config = {
          apiKey: 'AIzaSyDKpxmykTkOS26PlbfIYXQoJAJmBSLQh0Y',
          authDomain: 'speedy-f57c3.firebaseapp.com',
          databaseURL: 'https://speedy-f57c3.firebaseio.com',
        };

        // initialize firebase
        this.fbase = firebase.initializeApp(config);
      },
      properties: {
        fbase: {
          type: Object,
        },
      },
      observers: [
        'challengeRoute(route.path)'
      ],
      challengeRoute: function() {
        /*
          if(!this.route.path) {
            this.set('route.path', '/home');
          }
          else if(this.route.path == '/charts' && !this.fbase.auth().currentUser) {
            this.set('route.path', '/login')
          }
          */
      }
    });
  </script>
</dom-module>
